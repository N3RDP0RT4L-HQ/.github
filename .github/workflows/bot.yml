name: Bot workflow
on: [workflow_dispatch]

jobs:
  armv7_job:
    # The host should always be Linux
    runs-on: ubuntu-18.04
    name: Build on ubuntu-18.04 armv7
    steps:
      - uses: actions/checkout@v3
      - uses: uraimo/run-on-arch-action@v2
        name: Run commands
        id: runcmd
        with:
          arch: armv7
          distro: ubuntu18.04

          # Not required, but speeds up builds by storing container images in
          # a GitHub package registry.
          githubToken: ${{ github.token }}

          # Set an output parameter `uname` for use in subsequent steps
          run: |
            #sudo apt purge python3* -y
            sudo apt install python3.8-dev libxslt1-dev python3-lxml libffi-dev python3-pip libssl-dev build-essential libc-dev-bin linux-libc-dev libyaml-dev lib32ncurses5-dev -y
            # sudo cp -v /usr/bin/python3.8 /usr/bin/python3
            # Do not change anything we are simply moving python3.8 to replace the newer python3 to avoid the thing F-ing up!
            git clone https://github.com/N3RDP0RT4L-HQ/GoddessBlackHeartBot
            cd GoddessBlackHeartBot
            wget ${{ secrets.config }} -o config.json
            sudo python3.8 -m pip install --upgrade --force-reinstall -r requirements.txt
            python3.8 GBH.py
            echo ::set-output name=uname::$(uname -a)

      - name: Get the output
        # Echo the `uname` output parameter from the `runcmd` step
        run: |
          echo "The uname output was ${{ steps.runcmd.outputs.uname }}"
